# FazAI - Assinaturas de Malware
# Formato: assinatura,descrição,nível_risco,ação
# Ações: block, alert, log

# PHP Malicious Code
eval(,Execução de código malicioso,9,block
base64_decode(,Decodificação suspeita,7,alert
shell_exec(,Execução de shell,8,block
system(,Execução de sistema,8,block
passthru(,Execução de comando,8,block
exec(,Execução de processo,8,block
file_get_contents(,Leitura de arquivo suspeita,6,alert
file_put_contents(,Escrita de arquivo suspeita,6,alert
include(,Inclusão de arquivo suspeita,7,alert
require(,Requisição de arquivo suspeita,7,alert
file_exists(,Verificação de arquivo suspeita,5,log
unlink(,Remoção de arquivo suspeita,6,alert
rmdir(,Remoção de diretório suspeita,6,alert
mkdir(,Criação de diretório suspeita,5,alert
chmod(,Alteração de permissões suspeita,6,alert
chown(,Alteração de proprietário suspeita,6,alert

# SQL Injection
SELECT.*FROM.*WHERE.*OR.*1=1,SQL Injection,9,block
union.*select,SQL Injection UNION,9,block
union.*all.*select,SQL Injection UNION ALL,9,block
insert.*into,SQL Injection INSERT,8,block
update.*set,SQL Injection UPDATE,8,block
delete.*from,SQL Injection DELETE,8,block
drop.*table,SQL Injection DROP,9,block
create.*table,SQL Injection CREATE,7,block
alter.*table,SQL Injection ALTER,8,block
exec.*sp_,SQL Injection Stored Procedure,8,block
xp_cmdshell,SQL Injection Command Shell,9,block

# Cross-Site Scripting (XSS)
script.*alert,XSS Script Alert,8,block
javascript:,XSS JavaScript Protocol,8,block
vbscript:,XSS VBScript Protocol,8,block
onload=,XSS Event Handler,7,block
onerror=,XSS Error Handler,7,block
onclick=,XSS Click Handler,6,alert
onmouseover=,XSS Mouse Handler,6,alert
<img.*src.*javascript:,XSS Image JavaScript,8,block
<iframe.*src,XSS IFrame,7,block
<object.*data,XSS Object,7,block
<embed.*src,XSS Embed,7,block

# File Upload Attacks
.php.,PHP File Upload,9,block
.php3,PHP3 File Upload,9,block
.php4,PHP4 File Upload,9,block
.php5,PHP5 File Upload,9,block
.phtml,PHP HTML File Upload,9,block
.asp,ASP File Upload,8,block
.aspx,ASP.NET File Upload,8,block
.jsp,JSP File Upload,8,block
.cgi,CGI File Upload,8,block
.pl,Perl File Upload,7,block
.py,Python File Upload,7,block
.sh,Shell Script Upload,8,block
.bat,Batch File Upload,8,block
.exe,Executable File Upload,9,block
.com,COM File Upload,9,block
.dll,DLL File Upload,9,block

# Directory Traversal
../,Directory Traversal,8,block
..\\,Directory Traversal Windows,8,block
%2e%2e%2f,URL Encoded Directory Traversal,8,block
%2e%2e%5c,URL Encoded Windows Directory Traversal,8,block
....//,Double Directory Traversal,8,block
....\\\\,Double Windows Directory Traversal,8,block

# Command Injection
|,Command Pipe,7,block
;,Command Separator,7,block
&&,Command AND,7,block
||,Command OR,7,block
`,Command Backtick,8,block
$(,Command Substitution,8,block
%0a,URL Encoded Newline,7,block
%0d,URL Encoded Carriage Return,7,block

# Remote File Inclusion
http://,Remote File Inclusion HTTP,8,block
https://,Remote File Inclusion HTTPS,8,block
ftp://,Remote File Inclusion FTP,8,block
file://,Local File Inclusion,8,block
data://,Data URI Inclusion,8,block
php://,PHP Stream Inclusion,8,block

# LDAP Injection
*)(,LDAP Injection,8,block
*))(|,LDAP Injection OR,8,block
*))%00,LDAP Injection Null,8,block
admin*,LDAP Injection Admin,7,alert
*|*,LDAP Injection Wildcard,7,alert

# XML External Entity (XXE)
<!ENTITY,XXE Entity Declaration,8,block
<!DOCTYPE,XXE DOCTYPE,7,alert
SYSTEM,XXE System,8,block
PUBLIC,XXE Public,7,alert
%xx,XXE Parameter Entity,8,block

# Server-Side Template Injection
{{,Template Injection,8,block
{%,Template Injection,8,block
${,Template Injection,8,block
#{,Template Injection,8,block
<%,Template Injection,8,block

# NoSQL Injection
$where,NoSQL Injection Where,8,block
$ne,NoSQL Injection Not Equal,7,alert
$gt,NoSQL Injection Greater Than,7,alert
$lt,NoSQL Injection Less Than,7,alert
$regex,NoSQL Injection Regex,8,block
$exists,NoSQL Injection Exists,7,alert

# Deserialization Attacks
O:,PHP Object Serialization,8,block
a:,PHP Array Serialization,7,alert
s:,PHP String Serialization,6,log
i:,PHP Integer Serialization,6,log
b:,PHP Boolean Serialization,6,log

# Log Injection
%0d%0a,Log Injection CRLF,7,block
%0a,Log Injection LF,7,block
%0d,Log Injection CR,7,block
%09,Log Injection Tab,6,alert

# HTTP Header Injection
%0d%0a,Header Injection CRLF,8,block
%0a,Header Injection LF,8,block
%0d,Header Injection CR,8,block
Host:,Header Injection Host,7,alert
X-Forwarded-For:,Header Injection XFF,6,log

# Open Redirect
redirect=,Open Redirect Parameter,7,block
url=,Open Redirect URL,7,block
next=,Open Redirect Next,7,block
target=,Open Redirect Target,7,block
redir=,Open Redirect Redir,7,block
destination=,Open Redirect Destination,7,block

# SSRF (Server-Side Request Forgery)
http://127.0.0.1,SSRF Localhost,8,block
http://localhost,SSRF Localhost,8,block
http://0.0.0.0,SSRF Zero IP,8,block
http://169.254.169.254,SSRF AWS Metadata,9,block
http://169.254.170.2,SSRF AWS Metadata,9,block
http://metadata.google.internal,SSRF GCP Metadata,9,block
http://169.254.169.254/latest/meta-data/,SSRF AWS Metadata Path,9,block

# Path Traversal
/etc/passwd,Path Traversal Passwd,8,block
/etc/shadow,Path Traversal Shadow,9,block
/etc/hosts,Path Traversal Hosts,7,alert
/proc/version,Path Traversal Proc,7,alert
/proc/self/environ,Path Traversal Environ,8,block
/proc/self/cmdline,Path Traversal Cmdline,8,block
/proc/self/fd/,Path Traversal FD,7,alert

# Web Shell Indicators
cmd=,Web Shell Command,9,block
command=,Web Shell Command,9,block
exec=,Web Shell Exec,9,block
shell=,Web Shell,9,block
backdoor,Web Shell Backdoor,9,block
webshell,Web Shell,9,block
c99,Web Shell C99,9,block
r57,Web Shell R57,9,block
b374k,Web Shell B374K,9,block

# Cryptocurrency Mining
cryptonight,Crypto Mining Cryptonight,8,block
xmrig,Crypto Mining XMRig,8,block
coinhive,Crypto Mining Coinhive,8,block
minero,Crypto Mining Minero,8,block
cryptoloot,Crypto Mining Cryptoloot,8,block
coinimp,Crypto Mining CoinImp,8,block

# Botnet Indicators
botnet,Botnet Communication,9,block
c2,Command and Control,9,block
command.*control,Command and Control,9,block
beacon,Beacon Communication,8,block
heartbeat,Heartbeat Communication,7,alert
checkin,Check-in Communication,7,alert

# Data Exfiltration
email.*password,Data Exfiltration Email,8,block
credit.*card,Data Exfiltration Credit Card,9,block
ssn,Data Exfiltration SSN,9,block
social.*security,Data Exfiltration SSN,9,block
passport,Data Exfiltration Passport,9,block
driver.*license,Data Exfiltration Driver License,8,block

# Advanced Persistent Threat (APT)
apt,APT Indicator,9,block
persistent,APT Persistent,8,block
lateral.*movement,APT Lateral Movement,9,block
privilege.*escalation,APT Privilege Escalation,9,block
credential.*harvesting,APT Credential Harvesting,9,block
data.*exfiltration,APT Data Exfiltration,9,block